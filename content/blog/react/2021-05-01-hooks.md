---
title:  "React Hook"
description: "Hookì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì"
draft: false
template: "post"
category : "react"
tags:
  - js
  - react
date: 2021-05-01
---
### 0. ì‘ì„±í•˜ëŠ” ì´ìœ ?

- ê³µì‹ë¬¸ì„œ ìš”ì•½ì„ ë¹Œë¯¸ë¡œ Hookì— ëŒ€í•´ì„œ ë” ì•Œê³  ì‹¶ì–´ì„œ

### 1. [Hookì˜ ë“±ì¥í•˜ê²Œ ëœ ì´ìœ ](https://ko.reactjs.org/docs/hooks-intro.html#motivation)

1. ì»´í¬ë„ŒíŠ¸ ì‚¬ì´ì—ì„œ ìƒíƒœ ë¡œì§ì„ ì¬ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›€ â†’ Custom Hook ë“±ì¥ë°°ê²½(1)
    - Render Propsì™€ HOC ê°™ì€ íŒ¨í„´ì€ ì½”ë“œë¥¼ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€(â†’ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë µë‹¤)
    - ìƒíƒœ ê´€ë ¨ ë¡œì§ì„ ì¶”ìƒí™”í•˜ê¸° ì–´ë ¤ì›€
2. ë³µì¡í•œ ì»´í¬ë„ŒíŠ¸ë“¤ì€ ì´í•´í•˜ê¸° ì–´ë µë‹¤  â†’ Custom Hook ë“±ì¥ë°°ê²½(2)
    - lifeCycle Methodì—ëŠ” ê´€ë ¨ì—†ëŠ” ë¡œì§ì´ í¬í•¨ë˜ì–´ ì»´í¬ë„ŒíŠ¸ë¥¼  ì¬ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›€

        ```jsx
        componentDidUpdate(){
        	// ë°ì´í„° ìš”ì²­
        	// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡(í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‚¬ìš©ë˜ê¸° ë–„ë¬¸ì— ì¬ì‚¬ìš©ë˜ê¸° ì–´ë µë‹¤)
        }

        componentWillUnmount() {
        	// ì´ë²¤íŠ¸ ë¦¬ìŠ¤í„° í•´ì œ(í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‚¬ìš©ë˜ê¸° ë–„ë¬¸ì— ì¬ì‚¬ìš©ë˜ê¸° ì–´ë µë‹¤)
        }
        ```

    - ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ redux, mobxë¥¼ í†µí•´ ì „ì—­ì—ì„œ ìƒíƒœê´€ë¦¬ë¥¼ ì§„í–‰
3. ClassëŠ” ì‚¬ëŒê³¼ ê¸°ê³„ë¥¼ í˜¼ë™ì‹œí‚¨ë‹¤. â†’ hook api ì´ìš©
    - ë‹¤ë¥¸ì–¸ì–´ì™€ëŠ” ë‹¤ë¥´ê²Œ ì‘ë™í•˜ëŠ” this(Dynamic Scope)

### 2. State Hook

1. Class Componentì˜ this.setStateì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•œë‹¤.
2. ì™œ state Hookì¸ê°€ìš”?
    - React 16.8ì „ê¹Œì§€ë„ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ê°€ ìˆì—ˆì§€ë§Œ, stateë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì—ˆê³ , ë‹¨ìˆœíˆ propsë¥¼ ë°›ì•„ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë³´ì—¬ì£¼ëŠ” ì—­í• ë§Œ í•˜ì˜€ë‹¤. (stateê°€ í•„ìš”í•˜ë©´, class ì»´í¬ë„ŒíŠ¸ë¡œ ì‘ì„±)
    - í•¨ìˆ˜ì•ˆì—ì„œ stateë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤
3. ì‚¬ìš©ë²•
    - ë Œë”ë§ í• ë•Œ, ì˜¤ì§ í•œë²ˆë§Œ ìƒì„±ëœë‹¤(re-rednerí•˜ê¸°ì „ê¹Œì§€ ìœ ì§€)
    - useStateë¥¼ Destructuring ë¬¸ë²•ì„ í†µí•´ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  stateëª…, updateí•¨ìˆ˜ëª…ìœ¼ë¡œ ì„ ì–¸
    - ReactëŠ” hookì˜ ìˆœì„œë¥¼ ê°€ì§€ê³  ì´ì „ stateë¥¼ ì•Œ ìˆ˜ ìˆë‹¤(hookì˜ ê·œì¹™ ì°¸ê³ )

        ```jsx
        import React, { useState } from 'react';

        function Example() {
          const [count, setCount] = useState(0);

        	return (
        		<div>
        			<p> {count}</p>
        			<button onClick={() => setCount(count + 1)}>+ë²„íŠ¼</button>
        		</div>
        	)
        }
        ```

## 3. Effect Hook

1. componentDidMount + componentDidUpdate + componentWillUnmountì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•œë‹¤.
2. ì™œ Effect Hookì¸ê°€ìš”?
    - ë„¤íŠ¸ì›Œí¬ í†µì‹  ë° Component Domì¡°ì‘ì€ side Effectsë¼ê³  ì¹­í•œë‹¤
    - sideEffectëŠ” ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì— ì˜í–¥ì„ ì¤„ ìˆ˜ë„ ìˆê³ , ë Œë”ë§ ê³¼ì •ì—ì„œ êµ¬í˜„ í•  ìˆ˜ ì—†ë‹¤. (ë Œë”ë§ ì´í›„)
    - ì´ëŸ¬í•œ side effect ì‘ì—…ì„ í•  ìˆ˜ ìˆëŠ” ê³³ì´ê¸° ë•Œë¬¸ì—, effect hookì´ë¼ê³  í•œë‹¤.
3. ì‚¬ìš©ë²•
    - ë Œë”ë§ ì´í›„! useEffectì•ˆì— ìˆëŠ” ì½œë°±ì´ ì‹¤í–‰(Domì´ ì—…ë°ì´íŠ¸ë˜ì—ˆë‹¤ê³  ë³´ì¥)
    - ë Œë”ë§ ì´í›„ì´ê¸°ë•Œë¬¸ì—, ì»´í¬ë„ŒíŠ¸ ë”ì— ì ‘ê·¼í•˜ê±°ë‚˜, Stateì— ì ‘ê·¼ ê°€ëŠ¥
    - ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ í•´ì œë˜ì—ˆê±°ë‚˜,reRenderì‹œ clean-upì„ ì‹¤í–‰í•œë‹¤

        ```jsx
        function FriendStatus(props) {
          const [isOnline, setIsOnline] = useState(null);

          useEffect(() => {
            function handleStatusChange(status) {
              setIsOnline(status.isOnline);
            }
            ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
            // effect ì´í›„ì— ì–´ë–»ê²Œ ì •ë¦¬(clean-up)í•  ê²ƒì¸ì§€ í‘œì‹œí•©ë‹ˆë‹¤.
            return function cleanup() {
              ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
            };
          });

          if (isOnline === null) {
            return 'Loading...';
          }
          return isOnline ? 'Online' : 'Offline';
        }
        ```

4. Effect Hookì˜ ì¥ì 
    - useEffectë¥¼ ì—¬ëŸ¬ê°œ ì‚¬ìš©í•˜ì—¬, ì—­í• /ê´€ì‹¬ ë³„ë¡œ ë‚˜ëˆ„ì–´ì¤„ ìˆ˜ ìˆë‹¤.

        ```jsx
        function FriendStatusWithCounter(props) {

          const [count, setCount] = useState(0);
          useEffect(() => {
            document.title = `You clicked ${count} times`;
          });

          const [isOnline, setIsOnline] = useState(null);

          useEffect(() => {
            function handleStatusChange(status) {
              setIsOnline(status.isOnline);
            }

            ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
            return () => {
              ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
            };
          });
        }
        ```

    - ê°™ì€ ì—­í• ì´ì§€ë§Œ, Class ì»´í¬ë„ŒíŠ¸ë³´ë‹¤ ê°€ë…ì„±ì´ ë†’ë‹¤.

        ```jsx
        componentDidMount() {
            ChatAPI.subscribeToFriendStatus(
              this.props.friend.id,
              this.handleStatusChange
            );
          }

          componentDidUpdate(prevProps) {
            // ì´ì „ friend.idì—ì„œ êµ¬ë…ì„ í•´ì§€í•©ë‹ˆë‹¤.
            ChatAPI.unsubscribeFromFriendStatus(
              prevProps.friend.id,
              this.handleStatusChange
            );
            // ë‹¤ìŒ friend.idë¥¼ êµ¬ë…í•©ë‹ˆë‹¤.
            ChatAPI.subscribeToFriendStatus(
              this.props.friend.id,
              this.handleStatusChange
            );
          }

          componentWillUnmount() {
            ChatAPI.unsubscribeFromFriendStatus(
              this.props.friend.id,
              this.handleStatusChange
            );
          }

        useEffect(() => {
          function handleStatusChange(status) {
            setIsOnline(status.isOnline);
          }

          ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
          return () => {
            ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
          };
        }, [props.friend.id]); // props.friend.idê°€ ë°”ë€” ë•Œë§Œ ì¬êµ¬ë…í•©ë‹ˆë‹¤.
        ```

### 4. Hook ê·œì¹™

- ì˜¤ì§ React í•¨ìˆ˜ ë‚´ì—ì„œë§Œ Hookì„ í˜¸ì¶œí•´ì•¼í•œë‹¤ (Custom Hook í¬í•¨)
- Componentì˜ Hookì€ ë°˜ë³µì´ë‚˜, ì¡°ê±´ë¬¸ì— ë”°ë¼ ìˆœì„œê°€ ë³€ê²½ë˜ë©´ ì•ˆëœë‹¤(í˜¸ì¶œ ìˆœì„œë¡œ state ì ‘ê·¼)

    ```jsx
    function Form() {
      const [name, setName] = useState('Mary');
      useEffect(function persistForm() {
        localStorage.setItem('formData', name);
      });
      const [surname, setSurname] = useState('Poppins');
      useEffect(function updateTitle() {
        document.title = name + ' ' + surname;
      });
    }

    // ------------
    // ì²« ë²ˆì§¸ ë Œë”ë§
    // ------------
    useState('Mary')           // 1. 'Mary'ë¼ëŠ” name state ë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.
    useEffect(persistForm)     // 2. í¼ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ effectë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
    useState('Poppins')        // 3. 'Poppins'ë¼ëŠ” surname state ë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.
    useEffect(updateTitle)     // 4. ì œëª©ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•œ effectë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

    // -------------
    // ë‘ ë²ˆì§¸ ë Œë”ë§
    // -------------
    useState('Mary')           // 1. name state ë³€ìˆ˜ë¥¼ ì½ìŠµë‹ˆë‹¤.(ì¸ìëŠ” ë¬´ì‹œë©ë‹ˆë‹¤)
    useEffect(persistForm)     // 2. í¼ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ effectê°€ ëŒ€ì²´ë©ë‹ˆë‹¤.
    useState('Poppins')        // 3. surname state ë³€ìˆ˜ë¥¼ ì½ìŠµë‹ˆë‹¤.(ì¸ìëŠ” ë¬´ì‹œë©ë‹ˆë‹¤)
    useEffect(updateTitle)     // 4. ì œëª©ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•œ effectê°€ ëŒ€ì²´ë©ë‹ˆë‹¤.

    // ...
    ```

- ë§Œì•½ í˜¸ì¶œ ìˆœì„œê°€ ë³€ê²½ëœë‹¤ë©´?

    ```jsx
    // ğŸ”´ ì¡°ê±´ë¬¸ì— Hookì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì²« ë²ˆì§¸ ê·œì¹™ì„ ê¹¼ìŠµë‹ˆë‹¤
      if (name !== '') {
        useEffect(function persistForm() {
          localStorage.setItem('formData', name);
        });
      }

    useState('Mary')           // 1. name state ë³€ìˆ˜ë¥¼ ì½ìŠµë‹ˆë‹¤. (ì¸ìëŠ” ë¬´ì‹œë©ë‹ˆë‹¤)
    // useEffect(persistForm)  // ğŸ”´ Hookì„ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤!
    useState('Poppins')        // ğŸ”´ 2 (3ì´ì—ˆë˜). surname state ë³€ìˆ˜ë¥¼ ì½ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    useEffect(updateTitle)     // ğŸ”´ 3 (4ì˜€ë˜). ì œëª©ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•œ effectê°€ ëŒ€ì²´ë˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    ```

- ì¡°ê±´ì— ë”°ë¼ Hookì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´! í•¨ìˆ˜ë°”ë””ì—ì„œ ì¡°ê±´ì„ ì¶”ê°€ì‹œí‚¨ë‹¤.

    ```jsx
    useEffect(function persistForm() {
        // ğŸ‘ ë” ì´ìƒ ì²« ë²ˆì§¸ ê·œì¹™ì„ ì–´ê¸°ì§€ ì•ŠìŠµë‹ˆë‹¤
        if (name !== '') {
          localStorage.setItem('formData', name);
        }
      });
    ```

### 5. useCallback

- ë©”ëª¨ë¦¬ì œì´ì…˜ëœ **ì½œë°±**ì„ ë°˜í™˜í•œë‹¤!
- ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤(shouldComponentUpdate ì—­í• ê³¼ ë™ì¼)
- ìì‹ ì»´í¬ë„ŒíŠ¸ì— ì½œë°±ì„ ì „ë‹¬í•  ë•Œ ìœ ìš©
- í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ë‚´ë¶€ì— ì„ ì–¸ë˜ì–´ ìˆë˜ í‘œí˜„ì‹(ë³€ìˆ˜, ë˜ë‹¤ë¥¸ í•¨ìˆ˜ ë“±)ë„ ë§¤ë²ˆ ë‹¤ì‹œ ì„ ì–¸ë˜ì–´ ì‚¬ìš©ëœë‹¤.
- useCallback(fn, deps)ì€ useMemo(() => fn, deps)ì™€ ê°™ìŠµë‹ˆë‹¤.

    ```jsx
    const memoizedCallback = useCallback(
      () => {
        doSomething(a, b);
      },
      [a, b],
    );
    ```

### 6. useMemo

- ë©”ëª¨ë¦¬ì œì´ì…˜ëœ **ê°’**ì„ ë°˜í™˜í•œë‹¤!
- useMemoë¡œ ì „ë‹¬ëœ í•¨ìˆ˜ëŠ” ë Œë”ë§ ì¤‘ì— ì‹¤í–‰ëœë‹¤
- ë Œë”ë§ ì¤‘ì—ëŠ” í•˜ì§€ ì•ŠëŠ” ê²ƒì„ useMemo í•¨ìˆ˜ ë‚´ì—ì„œ êµ¬í˜„í•˜ë©´ ì•ˆë˜ë©°, useEffectì—ì„œ êµ¬í˜„í•´ì•¼ í•œë‹¤.
- useMemoëŠ” ì„±ëŠ¥ìµœì í™”ë¥¼ ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆì§€ë§Œ, ë³´ì¥í•  ìˆ˜ ì—†ë‹¤.

    ```jsx
    const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]);
    ```

### 7. useRef

- useRefëŠ” current í”„ë¡œí¼í‹°ì— refê°€ ê±¸ë ¤ì§„ Dom nodeì˜ ì†ì„±ì„ ì„¤ì •í•œë‹¤.
- userRefëŠ” ë³€ê²½ì„ ìºì¹˜í•  ìˆ˜ ì—†ë‹¤. ì¦‰ currentê°€ ë³€ê²½í•œë‹¤ê³  ë Œë”ë§ ë˜ì§€ ì•ŠëŠ”ë‹¤.

    ```jsx
    function TextInputWithFocusButton() {
      const inputEl = useRef(null);
      const onButtonClick = () => {
        // `current` points to the mounted text input element
        inputEl.current.focus();
      };
      return (
        <>
          <input ref={inputEl} type="text" />
          <button onClick={onButtonClick}>Focus the input</button>
        </>
      );
    }
    ```

### ê´€ë ¨ ì¶œì²˜

- [https://ko.reactjs.org/docs/hooks-intro.html](https://ko.reactjs.org/docs/hooks-intro.html)
- [https://ui.toast.com/weekly-pick/ko_20190731](https://ui.toast.com/weekly-pick/ko_20190731)
- [https://medium.com/@jan.hesters/usecallback-vs-usememo-c23ad1dc60](https://medium.com/@jan.hesters/usecallback-vs-usememo-c23ad1dc60)
